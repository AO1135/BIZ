<!doctype html>
<html lang="ja">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1" />
<title>Indent — チェックリスト</title>
<style>
body { font-family: 'Noto Sans JP', sans-serif; margin:0; background:#fff; color:#000; }
header { display:flex; justify-content:space-between; align-items:center; padding:10px; border-bottom:1px solid #ccc; background:#f9f9f9; position:sticky; top:0; z-index:10; }
h1 { font-size:18px; margin:0; }
main { padding:12px; padding-bottom:70px; }
button,input,select,textarea { font-size:16px; padding:8px; border:1px solid #000; border-radius:6px; box-sizing:border-box; }
button { background:#000; color:#fff; cursor:pointer; }
nav { position:fixed; bottom:0; left:0; right:0; display:flex; background:#000; z-index:20; }
nav button { flex:1; border:none; border-right:1px solid #fff; background:#000; color:#fff; padding:10px; }
nav button.active { background:#444; }
nav button:last-child { border-right:none; }
.hidden { display:none; }
.list-item { border:1px solid #000; padding:8px 10px; margin-bottom:6px; border-radius:6px; display:flex; justify-content:space-between; align-items:center; gap:8px; }
.item-left { display:flex; flex-direction:column; font-size:14px; flex:1; }
.small-btn { font-size:13px; padding:5px 8px; border-radius:6px; background:#1976d2; color:#fff; border:none; cursor:pointer; white-space:nowrap; min-width:50px; }
.small-btn:hover { background:#0d47a1; }
.item-left div { display:flex; gap:4px; flex-wrap:wrap; align-items:center; }
.small-input { font-size:14px; padding:4px; }
.small-input.qty { width:70px; }
.small-input.memo { width:100px; flex:1; }
.memo, .qty { font-size:12px; }
</style>
<script src="https://cdn.jsdelivr.net/npm/tesseract.js@4/dist/tesseract.min.js"></script>
</head>
<body>

<header>
  <h1 id="title">パスワード入力</h1>
  <button id="langBtn">日本語 / English</button>
</header>

<main>
<section id="page-password">
  <input id="passwordInput" type="password" placeholder="パスワードを入力" />
  <button id="passwordSubmit">ログイン</button>
  <p id="passwordError" style="color:red;display:none">パスワードが違います</p>
</section>

<section id="page-login" class="hidden">
  <input id="userIdInput" placeholder="ユーザーIDを入力" />
  <button id="loginSubmit">ログイン</button>
</section>

<section id="page-precheck" class="hidden">
  <h2 id="precheckTitle">チェック待ちリスト</h2>
  <div style="display:flex;gap:8px;margin-bottom:8px;flex-wrap:wrap;">
    <input id="productCodeInput" placeholder="7桁のコード" />
    <input id="productQtyInput" type="number" min="1" value="1" />
    <input id="productMemoInput" placeholder="メモ" />
    <button id="addProductBtn">追加</button>
    <button id="ocrBtn">OCR追加</button>
  </div>
  <div id="precheckList"></div>
  <button id="precheckConfirm">チェックリストへ確定</button>
  <button id="precheckReset">リセット</button>
</section>

<section id="page-checklist" class="hidden">
  <h2 id="checklistTitle">チェックリスト</h2>
  <div id="checklist"></div>
  <button id="checklistReset">リセット</button>
</section>

<section id="page-checked" class="hidden">
  <h2 id="checkedTitle">チェック済みリスト</h2>
  <div id="checkedList"></div>
</section>
</main>

<nav>
  <button id="navPrecheck">チェック前リスト</button>
  <button id="navChecklist">チェックリスト</button>
  <button id="navChecked">チェック済み一覧</button>
</nav>

<script>
const PASSWORD='0509';
let lang='ja';

const texts={
  ja:{
    passwordTitle:'パスワード入力', passwordPlaceholder:'パスワードを入力', loginTitle:'ログイン',
    precheckTitle:'チェック待ちリスト', checklistTitle:'チェックリスト', checkedTitle:'チェック済みリスト',
    wrongPass:'パスワードが違います', add:'追加', ocr:'OCR追加', confirm:'チェックリストへ確定', reset:'リセット',
    del:'削除', check:'✔', quantity:'数量', memo:'メモ', resetConfirm:'本当にリセットしますか？', copy:'コピー'
  },
  en:{
    passwordTitle:'Enter Password', passwordPlaceholder:'Enter password', loginTitle:'Login',
    precheckTitle:'Pre-Check List', checklistTitle:'Checklist', checkedTitle:'Checked Items',
    wrongPass:'Incorrect password', add:'Add', ocr:'Add via OCR', confirm:'Confirm to Checklist', reset:'Reset',
    del:'Delete', check:'✔', quantity:'Qty', memo:'Memo', resetConfirm:'Do you really want to reset?', copy:'Copy'
  }
};

const pages=['page-login','page-precheck','page-checklist','page-checked'];

function showPage(id){
  pages.forEach(p=>document.getElementById(p).classList.add('hidden'));
  document.getElementById(id).classList.remove('hidden');
  const key=id.replace('page-','')+'Title';
  document.getElementById('title').textContent=texts[lang][key] || '';
  document.querySelectorAll('nav button').forEach(btn=>btn.classList.remove('active'));
  if(id==='page-precheck') document.getElementById('navPrecheck').classList.add('active');
  if(id==='page-checklist') document.getElementById('navChecklist').classList.add('active');
  if(id==='page-checked') document.getElementById('navChecked').classList.add('active');
}

function applyLang(){
  document.getElementById('passwordInput').placeholder=texts[lang].passwordPlaceholder;
  document.getElementById('passwordError').textContent=texts[lang].wrongPass;
  document.getElementById('addProductBtn').textContent=texts[lang].add;
  document.getElementById('ocrBtn').textContent=texts[lang].ocr;
  document.getElementById('precheckConfirm').textContent=texts[lang].confirm;
  document.getElementById('precheckReset').textContent=texts[lang].reset;
  document.getElementById('checklistReset').textContent=texts[lang].reset;
}

document.getElementById('langBtn').onclick=()=>{ lang=(lang==='ja')?'en':'ja'; applyLang(); renderPrecheck(); };

// Password
document.getElementById('passwordSubmit').onclick=()=>{
  const val=document.getElementById('passwordInput').value;
  if(val===PASSWORD){ showPage('page-login'); }
  else{ const err=document.getElementById('passwordError'); err.style.display='block'; setTimeout(()=>err.style.display='none',2000); }
};

// Login
document.getElementById('loginSubmit').onclick=()=>{
  const id=document.getElementById('userIdInput').value.trim();
  if(!id) return alert('IDを入力してください');
  localStorage.setItem('indent:user',id);
  showPage('page-precheck');
};

let precheckList=JSON.parse(localStorage.getItem('indent:precheck')||'[]');

function saveData(){
  localStorage.setItem('indent:precheck',JSON.stringify(precheckList));
}

document.getElementById('addProductBtn').onclick = () => {
  const code = document.getElementById('productCodeInput').value.trim();
  const qty = parseInt(document.getElementById('productQtyInput').value, 10);
  const memo = document.getElementById('productMemoInput').value.trim();
  if (!code || isNaN(qty) || qty < 1) return alert('コードと数量を正しく入力してください');

  precheckList.push({ code, qty, memo });
  saveData();
  renderPrecheck();

  document.getElementById('productCodeInput').value = '';
  document.getElementById('product
